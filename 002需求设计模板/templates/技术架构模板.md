# 技术架构设计模板

> 用于确定技术选型和系统架构

---

我需要为[项目名称]设计技术架构，基础是mksaas-template，请帮我完成：

## 现有能力分析
mksaas-template已提供以下能力：
- **前端**：Next.js 15 + React 19 + shadcn/ui + Tailwind CSS
- **认证**：Better Auth（邮箱、OAuth）
- **数据库**：PostgreSQL + Drizzle ORM
- **支付**：Stripe
- **邮件**：Resend + React Email
- **国际化**：next-intl
- **分析**：Vercel Analytics + PostHog + OpenPanel
- **AI**：Vercel AI SDK（支持OpenAI、DeepSeek等）
- **部署**：Vercel（main分支）或Cloudflare Workers（cloudflare分支）

## 新增需求
我需要实现以下功能：
1. [功能1，例如：语义搜索]
2. [功能2，例如：文件存储]
3. [功能3，例如：异步任务处理]

## 设计要求
请输出以下内容：

### 1. 技术选型对比表
对每个新增需求，列出3个候选方案，对比：
- 优点
- 缺点
- 成本（免费层 + 付费层）
- 学习曲线
- 与mksaas-template的集成难度
- 推荐方案及理由

示例格式：
| 需求 | 方案1 | 方案2 | 方案3 | 推荐 |
|------|-------|-------|-------|------|
| 向量搜索 | Pinecone | Qdrant | Milvus | Pinecone（免费层足够MVP） |

### 2. 系统架构图
用Mermaid或ASCII画出：
- 前端层（页面、组件）
- API层（Next.js API Routes/Server Actions）
- 数据层（PostgreSQL、向量数据库）
- 存储层（对象存储）
- 第三方服务（AI API、支付、邮件）
- 异步任务层（队列、定时任务）

### 3. 数据模型设计
用Drizzle Schema格式定义所有表结构：
```typescript
// src/db/schema/[module].ts
export const tableName = pgTable('table_name', {
  id: uuid('id').primaryKey().defaultRandom(),
  // 其他字段
  createdAt: timestamp('created_at').defaultNow(),
  updatedAt: timestamp('updated_at').defaultNow(),
});
```

包含：
- 表名和字段定义
- 主键和外键关系
- 索引设计
- 与Better Auth的集成（如需要）

### 4. API设计
列出所有API端点：
```typescript
// 端点：POST /api/[endpoint]
// 功能：[描述]
// 认证：[是否需要登录]

Request: {
  // 请求参数
}

Response: {
  // 响应格式
}

// 错误处理
Error: {
  "error": "错误信息",
  "code": "ERROR_CODE"
}
```

### 5. 部署方案
说明：
- 如何在Vercel上部署（环境变量、数据库连接）
- 如何在Cloudflare上部署（如需要）
- 数据库迁移策略（Drizzle Kit）
- 环境管理（开发、预览、生产）

### 6. 成本估算
列出所有第三方服务的费用：

| 服务 | 免费层 | 付费层 | MVP阶段 | 规模化阶段 |
|------|--------|--------|---------|------------|
| Vercel | 免费 | $20/月 | 免费 | Pro |
| PostgreSQL | Supabase免费500MB | $25/月 | 免费 | Pro |
| ... | ... | ... | ... | ... |

总计：
- MVP阶段：约$X/月
- 规模化阶段：约$Y/月

请开始设计，输出完整的技术架构文档。

---

## 填写示例

```markdown
新增需求：
1. 语义搜索（需要向量数据库）
2. PPT文件存储（需要对象存储）
3. 异步任务处理（需要任务队列）
```
