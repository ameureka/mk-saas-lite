# 需求设计常见陷阱与避免方法

本文档列举需求设计中最常见的5大陷阱，以及如何避免它们。

---

## 陷阱1：需求过于抽象

### 表现

**❌ 不好的需求描述**：
```markdown
需求：系统应该支持搜索功能
说明：用户可以搜索PPT模板
```

**问题**：
- 没有说明搜索的触发条件
- 没有说明搜索的响应行为
- 没有说明搜索的性能要求
- 无法据此编写测试用例

### 为什么会陷入这个陷阱？

1. **缺乏用户视角**：从技术角度而非用户角度描述需求
2. **懒惰思维**：不愿意深入思考细节
3. **经验不足**：不知道需求应该写到什么程度
4. **时间压力**：为了快速完成而忽略细节

### 如何避免？

#### 方法1：使用EARS格式

**✅ 好的需求描述**：
```markdown
需求1：智能语义搜索（P0）

用户故事：
作为用户，我希望通过自然语言描述找到合适的PPT模板，
以便快速获取符合需求的资源

验收标准（EARS格式）：
1. WHEN User输入自然语言查询，THE Platform SHALL生成查询文本的embedding向量
2. WHEN Platform接收到查询向量，THE Platform SHALL在Vector_Database中检索相似度最高的前10个Template
3. THE Platform SHALL在3秒内返回搜索结果
4. WHEN Platform返回搜索结果，THE Platform SHALL显示每个Template的预览图、标题、摘要和标签
5. IF 搜索无结果，THEN THE Platform SHALL显示推荐的热门模板
6. WHILE User未登录，THE Platform SHALL允许搜索但限制下载
```

#### 方法2：5W1H法

对每个需求，回答以下问题：
- **Who**：谁会用这个功能？
- **What**：具体要做什么？
- **When**：什么时候触发？
- **Where**：在哪个页面/场景？
- **Why**：为什么需要这个功能？
- **How**：如何实现（技术方案）？

#### 方法3：场景化描述

用具体场景而非抽象功能描述需求：

```markdown
场景1：职场人士周五下午准备下周一的汇报
- 用户打开网站
- 在搜索框输入"新能源行业年终总结"
- 系统在3秒内返回10个相关模板
- 用户点击第一个模板查看详情
- 用户点击下载，输入邮箱获取链接
- 用户收到邮件，点击链接下载PPT
```

### 检查方法

**自问**：
- 测试人员能否根据这个需求编写测试用例？
- 开发人员能否根据这个需求开始编码？
- 产品经理能否根据这个需求验收功能？

如果任何一个答案是"不能"，说明需求过于抽象。

---

## 陷阱2：技术选型缺乏依据

### 表现

**❌ 不好的技术选型**：
```markdown
技术栈：
- 前端：Next.js
- 数据库：PostgreSQL
- 向量库：Pinecone
- 缓存：Redis
```

**问题**：
- 没有说明为什么选择这些技术
- 没有对比其他候选方案
- 没有考虑团队能力和学习成本
- 没有考虑成本和可扩展性

### 为什么会陷入这个陷阱？

1. **跟风心态**："大家都在用，我也用"
2. **技术驱动**："我想学这个技术"
3. **经验主义**："我以前用过，所以继续用"
4. **懒惰思维**：不愿意做技术调研和对比

### 如何避免？

#### 方法1：技术选型对比表

**✅ 好的技术选型**：
```markdown
## 向量数据库选型

| 方案 | 优点 | 缺点 | 成本 | 学习曲线 | 推荐 |
|------|------|------|------|----------|------|
| Pinecone | 免费层5M向量<br>无需运维<br>查询快<100ms | 付费后$70/月<br>数据在国外 | MVP:$0<br>规模化:$70/月 | 低（有SDK） | ✅ MVP阶段 |
| Qdrant | 免费层1M向量<br>开源可自建<br>性能好 | 免费层限制多<br>需要运维 | MVP:$0<br>自建:$50/月 | 中（需要Docker） | 增长阶段 |
| Milvus | 完全开源<br>功能强大<br>可定制 | 需要自建<br>运维复杂<br>成本高 | 自建:$100/月 | 高（需要K8s） | 规模化阶段 |

**选择**：MVP阶段使用Pinecone
**理由**：
1. 免费层足够1万个模板（5M向量）
2. 无需运维，开箱即用，节省开发时间
3. 有官方Node.js SDK，集成简单
4. 查询延迟<100ms，满足性能要求
5. 后续可迁移到自建Milvus降低成本
```

#### 方法2：决策树

```
需要向量搜索？
├─ 是 → 数据量多大？
│   ├─ <1M → Pinecone免费层
│   ├─ 1M-10M → Qdrant Cloud
│   └─ >10M → 自建Milvus
└─ 否 → PostgreSQL全文搜索
```

#### 方法3：基于约束的选择

列出所有约束条件，然后选择满足约束的方案：

```markdown
约束条件：
- 预算：MVP阶段<$100/月
- 时间：2周内上线
- 团队：1人全栈，熟悉Node.js
- 规模：初期1万个模板

满足约束的方案：
✅ Pinecone：免费层，2小时集成，有Node.js SDK
❌ Milvus：需要服务器成本，需要1周学习和部署
❌ 自建Faiss：需要自己封装API，开发时间长
```

### 检查方法

**自问**：
- 为什么选择这个技术而不是其他？
- 这个技术的成本是多少？
- 团队是否有人熟悉这个技术？
- 如果这个技术不合适，有什么替代方案？

---

## 陷阱3：阶段划分不合理

### 表现

**❌ 不好的阶段划分**：
```markdown
第一阶段：实现所有功能（时间待定）
- 搜索功能
- 详情页
- 下载功能
- 用户系统
- 积分系统
- 广告系统
- 推荐系统
- 管理后台
- ...
```

**问题**：
- 阶段太大，无法快速验证
- 没有明确的时间限制
- 没有优先级区分
- 无法独立部署和验证

### 为什么会陷入这个陷阱？

1. **完美主义**：想一次做完所有功能
2. **缺乏经验**：不知道如何拆分阶段
3. **需求不清**：没有明确核心功能和次要功能
4. **压力驱动**：觉得时间紧，想一次做完

### 如何避免？

#### 方法1：MVP优先原则

**✅ 好的阶段划分**：
```markdown
阶段0：MVP验证（1-2周）
目标：验证核心假设 - 用户是否愿意用语义搜索找PPT
功能：
- [ ] 基础搜索页（关键词匹配，暂不用向量）
- [ ] 模板详情页（展示预览图、标题、标签）
- [ ] 简单下载功能（直接生成R2链接）
- [ ] 手动导入100个模板数据
验收：用户能搜索、查看、下载模板，DAU>50

阶段1：智能化增强（2-3周）
目标：引入AI语义搜索，提升搜索准确率
功能：
- [ ] 集成OpenAI Embedding API
- [ ] 接入Pinecone向量数据库
- [ ] 实现自然语言搜索
- [ ] 添加"相似推荐"功能
验收：搜索准确率>80%，用户满意度>4.0

阶段2：商业化闭环（2周）
目标：建立收益模式
功能：
- [ ] 用户注册/登录（Better Auth）
- [ ] 积分系统
- [ ] 广告集成
- [ ] 邮箱验证下载
验收：DAU>100，下载转化率>30%，月收入>$500

阶段3：规模化优化（持续）
目标：支持更大规模
功能：
- [ ] 性能优化
- [ ] 成本优化
- [ ] 管理后台
验收：支持10万+模板，DAU>2000
```

#### 方法2：3周规则

每个阶段不超过3周，原因：
- 3周足够完成一个完整的功能模块
- 3周可以保持团队的专注和动力
- 3周可以快速获取用户反馈
- 3周可以及时调整方向

#### 方法3：独立交付原则

每个阶段必须可以独立部署和验证：

```markdown
检查清单：
✅ 这个阶段完成后，能否部署到生产环境？
✅ 这个阶段完成后，用户能否使用？
✅ 这个阶段完成后，能否收集到有效反馈？
✅ 这个阶段完成后，能否验证核心假设？

如果任何一个答案是"不能"，说明阶段划分不合理。
```

### 检查方法

**自问**：
- 这个阶段的时间是否超过3周？
- 这个阶段完成后能否独立部署？
- 这个阶段的目标是否明确且可验证？
- 如果这个阶段失败，是否可以快速调整？

---

## 陷阱4：忽略非功能需求

### 表现

**❌ 不好的需求文档**：
```markdown
功能需求：
1. 搜索功能
2. 详情页
3. 下载功能
4. 用户系统
...

（没有性能、安全、监控等非功能需求）
```

**问题**：
- 没有性能指标，可能导致系统很慢
- 没有安全措施，可能导致数据泄露
- 没有监控手段，无法发现问题
- 没有SEO优化，无法获取自然流量

### 为什么会陷入这个陷阱？

1. **功能导向**：只关注"做什么"，不关注"做得怎么样"
2. **经验不足**：不知道非功能需求的重要性
3. **时间压力**：觉得非功能需求可以后续再做
4. **认知偏差**：觉得"能用就行"

### 如何避免？

#### 方法1：4类非功能需求

**✅ 完整的非功能需求**：
```markdown
## 4. 非功能需求

### 4.1 性能要求
- 搜索响应时间：< 3秒（包含embedding生成 + 向量检索）
- 页面加载时间：< 2秒（首屏）
- 并发支持：> 1000 QPS（通过Vercel Edge Network）
- 向量检索延迟：< 100ms（Pinecone保证）
- 数据库查询：< 50ms（通过索引优化）

### 4.2 安全要求
- 下载链接：48小时过期，签名验证防止盗链
- 邮箱验证：防止机器人批量注册和下载
- API限流：100次/分钟/IP（使用Vercel Edge Config）
- 数据加密：敏感信息（邮箱、支付）使用AES-256加密
- CSRF保护：使用Next.js内置CSRF保护
- SQL注入防护：使用Drizzle ORM参数化查询

### 4.3 可观测性
- 错误监控：Sentry集成（捕获前后端错误）
- 用户行为：PostHog追踪（搜索词、点击、下载）
- 性能监控：Vercel Analytics（Core Web Vitals）
- 业务指标：自定义Dashboard（DAU、转化率、收入）
- 日志记录：关键操作和错误日志
- 告警机制：异常情况自动通知（邮件/Slack）

### 4.4 SEO/AIO优化
- 独立URL：每个模板 `/templates/[id]`
- Meta标签：动态生成title、description、og:image
- Schema.org：CreativeWork结构化数据
- Sitemap：自动生成并提交到搜索引擎
- RSS Feed：供AI模型抓取
- 性能优化：Core Web Vitals > 90分
```

#### 方法2：FURPS+模型

使用FURPS+模型确保覆盖所有非功能需求：

- **F**unctionality（功能性）：已在功能需求中
- **U**sability（可用性）：UI/UX、响应式、国际化
- **R**eliability（可靠性）：可用性、容错、恢复
- **P**erformance（性能）：响应时间、吞吐量、资源使用
- **S**upportability（可支持性）：可维护性、可测试性、可扩展性
- **+**：安全性、合规性、可观测性

#### 方法3：用户体验视角

从用户体验角度思考非功能需求：

```markdown
用户期望：
- 快速：页面加载快，搜索响应快
- 稳定：不会突然崩溃或出错
- 安全：数据不会泄露，不会被攻击
- 可发现：能被搜索引擎找到
- 可追踪：能看到自己的下载历史

对应的非功能需求：
- 性能要求：响应时间<3秒
- 可靠性要求：可用性>99.9%
- 安全要求：数据加密、API限流
- SEO要求：Meta标签、Sitemap
- 可观测性：用户行为追踪
```

### 检查方法

**自问**：
- 如果系统很慢，用户会怎么想？
- 如果系统被攻击，会有什么后果？
- 如果系统出错，如何快速发现和修复？
- 如果用户搜索不到网站，如何获取流量？

---

## 陷阱5：成本预估过于乐观

### 表现

**❌ 不好的成本预估**：
```markdown
成本预估：
- 开发成本：免费（自己开发）
- 运营成本：免费（使用免费层）
- 总计：$0/月
```

**问题**：
- 没有考虑人力成本
- 没有考虑超出免费层后的成本
- 没有考虑隐藏成本（学习、维护）
- 没有考虑增长后的成本

### 为什么会陷入这个陷阱？

1. **乐观偏差**：总是往好的方面想
2. **经验不足**：不知道真实成本
3. **选择性忽视**：只看免费层，不看付费层
4. **压力驱动**：为了让项目看起来可行

### 如何避免？

#### 方法1：3场景预测

**✅ 完整的成本预估**：
```markdown
## 7. 成本预估

### 7.1 开发成本（一次性）
- 人力成本：1人 × 4周 × $500/周 = $2000
- 第三方服务（开发阶段）：
  - OpenAI API（测试）：$10
  - 域名：$12/年
- 总计：$2022

### 7.2 运营成本（月度）

| 服务 | 免费层 | MVP阶段 | 增长阶段 | 规模化阶段 |
|------|--------|---------|----------|------------|
| Vercel | 免费 | $0 | $20 | $20 |
| Supabase | 500MB | $0 | $25 | $25 |
| Pinecone | 5M向量 | $0 | $70 | 自建$50 |
| R2 | 10GB | $0 | $5 | $20 |
| OpenAI | 按量 | $10 | $50 | $200 |
| Resend | 3K封 | $0 | $20 | $20 |
| Sentry | 5K事件 | $0 | $26 | $26 |
| **总计** | - | **$10** | **$216** | **$361** |

### 7.3 场景分析

| 指标 | 悲观场景 | 中性场景 | 乐观场景 |
|------|---------|---------|---------|
| DAU | 20 | 100 | 500 |
| 月收入 | $50 | $300 | $1500 |
| 月成本 | $50 | $216 | $361 |
| 月利润 | $0 | $84 | $1139 |
| 回本周期 | 永不 | 24个月 | 2个月 |

### 7.4 成本优化建议
1. 使用DeepSeek替代OpenAI（成本降低70%）
2. 自建Milvus替代Pinecone（月省$70）
3. 使用CDN缓存减少API调用（月省$20）
4. 压缩预览图减少存储成本（月省$10）

预计优化后月成本：$150（规模化阶段）
```

#### 方法2：隐藏成本清单

列出所有可能的隐藏成本：

```markdown
隐藏成本：
- 学习成本：学习新技术的时间（1-2周）
- 维护成本：修复bug、更新依赖（每周2小时）
- 客服成本：回复用户问题（每天1小时）
- 营销成本：推广获客（$100/月）
- 法务成本：版权问题处理（$500/年）
- 机会成本：做这个项目而放弃的其他机会
```

#### 方法3：成本增长曲线

预测不同阶段的成本增长：

```markdown
成本增长曲线：

月份 | DAU | 月成本 | 主要增长项
-----|-----|--------|------------
1    | 50  | $10    | 基础服务
2    | 100 | $20    | AI API增加
3    | 500 | $100   | 超出免费层
6    | 2000| $300   | 全面付费
12   | 5000| $500   | 规模化优化

关键节点：
- 第3个月：超出免费层，成本跳升
- 第6个月：需要升级所有服务
- 第12个月：需要自建部分服务降低成本
```

### 检查方法

**自问**：
- 如果用户增长10倍，成本会增长多少？
- 如果某个服务涨价，有什么替代方案？
- 如果项目失败，已投入的成本能否接受？
- 是否考虑了所有隐藏成本？

---

## 总结：如何避免所有陷阱？

### 核心原则

1. **具体化**：用EARS格式和场景化描述，避免抽象
2. **有依据**：技术选型要对比和说明理由
3. **小步快跑**：阶段划分要小，快速验证
4. **全面性**：不要忽略非功能需求
5. **现实性**：成本预估要考虑多种场景

### 检查方法

使用 `03-检查清单.md` 逐项检查，确保没有陷入这些陷阱。

### 持续改进

- 每个项目结束后回顾：哪些陷阱踩了？如何避免？
- 建立团队的最佳实践库
- 定期更新检查清单和陷阱列表

---

**下一步**：查看 `05-快速上手指南.md` 学习如何2小时完成需求文档
