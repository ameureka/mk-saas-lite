# 需求描述示例对比

通过实际案例对比好坏需求描述的差异，帮助你快速掌握需求编写技巧。

---

## 示例1：搜索功能

### ❌ 不好的描述

```markdown
需求：实现搜索功能

说明：用户可以搜索PPT模板
```

**问题**：
- 过于抽象，无法据此开发
- 没有说明搜索的触发条件和响应行为
- 没有性能要求
- 没有异常处理
- 无法编写测试用例

---

### ✅ 好的描述

```markdown
需求1：智能语义搜索（P0）

用户故事：
作为用户，我希望通过自然语言描述找到合适的PPT模板，
以便快速获取符合需求的资源

使用场景：
- 职场人士周五下午需要准备下周一的汇报PPT
- 输入"新能源行业年终总结，蓝色商务风格"
- 期望快速找到3-5个相关模板

验收标准（EARS格式）：
1. WHEN User输入自然语言查询，THE Platform SHALL生成查询文本的embedding向量
2. WHEN Platform接收到查询向量，THE Platform SHALL在Vector_Database中检索相似度最高的前10个Template
3. THE Platform SHALL在3秒内返回搜索结果
4. WHEN Platform返回搜索结果，THE Platform SHALL显示每个Template的预览图、标题、摘要和标签
5. THE Platform SHALL支持中文和英文查询
6. IF 搜索无结果，THEN THE Platform SHALL显示推荐的热门模板
7. WHILE User未登录，THE Platform SHALL允许搜索但限制下载

技术实现：
- 前端：搜索页组件（src/app/[locale]/search/page.tsx）
- 后端：POST /api/search端点，调用OpenAI Embedding + Pinecone检索
- 数据库：templates表存储元数据，Pinecone存储向量
- 依赖：需要先完成模板数据导入和embedding生成

验证方式：
- 单元测试：测试embedding生成和向量检索逻辑
- 集成测试：测试完整搜索流程（输入→embedding→检索→返回）
- 用户验证：邀请10个用户测试，搜索准确率>70%
- 监控指标：PostHog追踪搜索词、点击率、转化率

成功指标：
- 搜索准确率 > 70%（通过用户反馈和点击率计算）
- 平均响应时间 < 3秒
- 用户满意度 > 4.0/5.0
```

**优点**：
- 有明确的用户故事和使用场景
- 使用EARS格式编写验收标准
- 包含技术实现方案
- 有验证方式和成功指标
- 可以据此编写测试用例和开发代码

---

## 示例2：下载功能

### ❌ 不好的描述

```markdown
需求：用户可以下载PPT模板

功能：点击下载按钮，下载文件
```

**问题**：
- 没有说明下载的前置条件（是否需要登录？）
- 没有说明下载链接的生成方式
- 没有说明下载限制
- 没有考虑安全性（防盗链）
- 没有考虑用户留存（邮箱收集）

---

### ✅ 好的描述

```markdown
需求4：下载权限管理（P1）

用户故事：
作为用户，我希望通过简单的验证获取下载链接，
以便快速下载所需模板，同时平台能持续提供服务

业务价值：
- 收集用户邮箱用于营销和留存
- 通过广告或积分变现
- 防止恶意批量下载

验收标准（EARS格式）：
1. WHEN User点击下载按钮，THE Platform SHALL弹出邮箱验证或积分选择界面
2. WHEN User首次下载，THE Platform SHALL允许免费下载无需观看广告
3. WHEN User第二次及以后下载，THE Platform SHALL提供观看广告或消耗Credits两种选项
4. WHEN User选择观看广告，THE Platform SHALL在广告播放完成后生成下载链接
5. WHEN User选择使用Credits，THE Platform SHALL扣除1个Credit并立即生成下载链接
6. THE Platform SHALL生成有效期为48小时的COS对象存储下载链接
7. THE Platform SHALL在下载链接中包含签名验证防止盗链
8. WHEN下载链接过期，THE Platform SHALL提示User重新获取链接
9. THE Platform SHALL记录每次下载到Meta_Database用于分析

技术实现：
- 前端：下载弹窗组件（src/components/download-modal.tsx）
- 后端：POST /api/download端点
  - 验证用户邮箱或积分
  - 生成签名的R2临时链接（48小时有效）
  - 记录下载记录
- 数据库：downloads表记录下载历史
- 第三方：Cloudflare R2对象存储

API设计：
```typescript
POST /api/download
Request: {
  templateId: string;
  method: 'free' | 'ad' | 'credits';
  email?: string; // method='free'或'ad'时必需
}

Response: {
  downloadLink: string; // 48小时有效的签名链接
  expiresAt: string; // ISO 8601格式
  creditsRemaining?: number; // method='credits'时返回
}

Error: {
  error: string;
  code: 'INSUFFICIENT_CREDITS' | 'INVALID_EMAIL' | 'TEMPLATE_NOT_FOUND';
}
```

数据模型：
```typescript
export const downloads = pgTable('downloads', {
  id: uuid('id').primaryKey().defaultRandom(),
  userId: uuid('user_id').references(() => users.id),
  templateId: uuid('template_id').references(() => templates.id),
  downloadLink: text('download_link'),
  expiresAt: timestamp('expires_at'),
  method: text('method'), // 'ad' | 'credits' | 'free'
  createdAt: timestamp('created_at').defaultNow(),
});
```

验证方式：
- 单元测试：测试链接生成、签名验证、过期检查
- 集成测试：测试完整下载流程（点击→验证→生成链接→下载）
- 安全测试：测试盗链防护、链接过期
- 用户验证：测试不同方式的下载体验

成功指标：
- 下载转化率 > 30%（从搜索到下载）
- 邮箱收集率 > 80%（首次下载用户）
- 广告观看完成率 > 60%
- 链接盗用率 < 1%
```

**优点**：
- 考虑了业务价值和变现模式
- 详细的验收标准覆盖各种场景
- 完整的技术实现方案（API、数据模型）
- 考虑了安全性（签名、过期）
- 有明确的成功指标

---

## 示例3：技术选型

### ❌ 不好的描述

```markdown
技术栈：
- 前端：Next.js
- 数据库：PostgreSQL
- 向量库：Pinecone
- 缓存：Redis
```

**问题**：
- 没有说明为什么选择这些技术
- 没有对比其他方案
- 没有考虑成本
- 没有考虑团队能力

---

### ✅ 好的描述

```markdown
## 3.1 技术选型

### 向量数据库选型

#### 需求分析
- 数据规模：初期1万个模板，每个1536维向量
- 查询性能：< 100ms
- 预算限制：MVP阶段 < $100/月
- 团队能力：1人全栈，熟悉Node.js，无运维经验

#### 候选方案对比

| 方案 | 优点 | 缺点 | 成本 | 学习曲线 | 集成难度 |
|------|------|------|------|----------|----------|
| **Pinecone** | • 免费层5M向量<br>• 无需运维<br>• 查询快<100ms<br>• 有Node.js SDK | • 付费后$70/月<br>• 数据在国外<br>• 依赖第三方 | MVP:$0<br>增长:$70/月<br>规模化:$70/月 | 低<br>（2小时上手） | 低<br>（官方SDK） |
| **Qdrant** | • 免费层1M向量<br>• 开源可自建<br>• 性能好<br>• 支持过滤 | • 免费层限制多<br>• 需要运维<br>• 文档较少 | MVP:$0<br>增长:$50/月<br>规模化:$50/月 | 中<br>（1天上手） | 中<br>（需Docker） |
| **Milvus** | • 完全开源<br>• 功能强大<br>• 可定制<br>• 社区活跃 | • 需要自建<br>• 运维复杂<br>• 成本高<br>• 学习曲线陡 | MVP:$100/月<br>增长:$100/月<br>规模化:$100/月 | 高<br>（1周上手） | 高<br>（需K8s） |
| **PGVector** | • 与PostgreSQL集成<br>• 无额外成本<br>• 简单 | • 性能较差<br>• 功能有限<br>• 不适合大规模 | $0 | 低<br>（1小时上手） | 低<br>（SQL扩展） |

#### 决策矩阵

```
           成本  性能  易用性  可扩展性  总分
Pinecone    5    5     5       4        19  ✅
Qdrant      4    5     3       5        17
Milvus      2    5     2       5        14
PGVector    5    2     5       2        14
```

#### 最终选择：Pinecone

**理由**：
1. **成本优势**：免费层5M向量足够1万个模板（每个1536维 ≈ 6KB，总计60MB）
2. **零运维**：无需自建服务器，节省开发和运维时间
3. **快速集成**：有官方Node.js SDK，2小时内可完成集成
4. **性能保证**：查询延迟<100ms，满足用户体验要求
5. **可迁移性**：后续可迁移到自建Milvus，数据格式兼容

**风险与应对**：
- **风险1**：超出免费层后$70/月
  - 应对：监控向量数量，接近5M时迁移到自建Milvus
- **风险2**：依赖第三方服务
  - 应对：定期导出数据备份，保留迁移方案
- **风险3**：数据在国外，访问延迟
  - 应对：使用CDN加速，或选择Pinecone的亚洲区域

**迁移路径**：
```
阶段0-1（MVP-增长）：Pinecone免费层
  ↓ 向量数接近5M
阶段2（商业化）：Pinecone付费层（$70/月）
  ↓ 成本优化需求
阶段3（规模化）：自建Milvus（$50/月）
```

**实施计划**：
1. 第1周：集成Pinecone SDK，实现基础向量检索
2. 第2周：优化查询性能，添加过滤条件
3. 第3周：监控和告警，设置向量数量阈值
4. 第6个月：评估迁移到Milvus的必要性
```

**优点**：
- 详细的需求分析和对比
- 量化的决策矩阵
- 明确的选择理由
- 考虑了风险和应对
- 有清晰的迁移路径

---

## 示例4：阶段规划

### ❌ 不好的描述

```markdown
第一阶段：实现所有功能
- 搜索
- 详情
- 下载
- 用户系统
- 积分系统
- 广告
- 推荐
- 管理后台

时间：待定
```

**问题**：
- 阶段太大，无法快速验证
- 没有优先级区分
- 没有时间限制
- 没有验收标准
- 无法独立部署

---

### ✅ 好的描述

```markdown
## 5. 实施计划

### 阶段0：MVP验证（1-2周）

**目标**：验证核心假设 - 用户是否愿意用语义搜索找PPT

**功能清单**：
- [ ] 基础搜索页（2天）
  - 实现搜索框和结果列表UI
  - 使用PostgreSQL全文搜索（暂不用向量）
  - 支持按标题和标签搜索
  
- [ ] 模板详情页（1天）
  - 展示模板预览图、标题、标签
  - 展示下载按钮
  - 暂不实现相似推荐
  
- [ ] 简单下载功能（1天）
  - 直接生成R2对象存储链接
  - 无需邮箱验证
  - 无需积分系统
  
- [ ] 数据准备（2天）
  - 手动导入100个测试模板
  - 生成预览图
  - 上传到R2存储
  
- [ ] 部署到Vercel（0.5天）
  - 配置环境变量
  - 连接Supabase数据库
  - 配置R2存储

**验收标准**：
- ✅ 用户能搜索、查看、下载模板
- ✅ 页面加载速度 < 3秒
- ✅ 无严重bug，基本可用
- ✅ DAU > 50（邀请种子用户测试）
- ✅ 搜索到下载的转化率 > 20%

**技术栈**：
- 复用：Next.js + PostgreSQL（Supabase免费层）+ Cloudflare R2
- 新增：无（全部使用mksaas-template现有能力）
- 成本：$0/月（全部免费层）

**风险点**：
- 风险1：PostgreSQL全文搜索准确率低
  - 应对：收集用户反馈，为阶段1的向量搜索提供数据
- 风险2：100个模板不够测试
  - 应对：优先选择热门类别的模板

**下一阶段依赖**：
- 收集到至少50个用户的搜索词和点击数据
- 验证用户对语义搜索的需求

---

### 阶段1：智能化增强（2-3周）

**目标**：引入AI语义搜索，提升搜索准确率到80%

**功能清单**：
- [ ] 集成OpenAI Embedding API（1天）
  - 注册OpenAI账号，获取API Key
  - 实现embedding生成函数
  - 测试embedding质量
  
- [ ] 接入Pinecone向量数据库（2天）
  - 注册Pinecone账号
  - 创建索引（1536维）
  - 实现向量插入和查询
  
- [ ] 实现自然语言搜索（3天）
  - 修改搜索API，支持向量检索
  - 优化搜索结果排序（相似度 + 热度）
  - 添加搜索历史记录
  
- [ ] 批量处理现有模板（2天）
  - 为100个模板生成embedding
  - 导入到Pinecone
  - 验证检索效果
  
- [ ] 添加"相似推荐"功能（2天）
  - 在详情页底部显示3-5个相似模板
  - 基于embedding相似度计算
  - 添加点击追踪

**验收标准**：
- ✅ 搜索准确率 > 80%（通过用户反馈和点击率计算）
- ✅ 向量检索延迟 < 200ms
- ✅ 支持1000+模板的语义搜索
- ✅ 相似推荐点击率 > 15%
- ✅ DAU > 100

**技术栈**：
- 新增：OpenAI Embedding API + Pinecone免费层
- 成本：约$10/月（OpenAI API按量计费）

**风险点**：
- 风险1：OpenAI API限流
  - 应对：实现请求队列和重试机制
- 风险2：Pinecone免费层不够用
  - 应对：监控向量数量，优化embedding策略

---

### 阶段2：商业化闭环（2周）

**目标**：建立收益模式，实现月收入>$500

**功能清单**：
- [ ] 用户注册/登录（2天）
  - 使用Better Auth（已集成）
  - 支持邮箱和Google OAuth
  - 实现用户中心页面
  
- [ ] 积分系统（3天）
  - 实现积分表和交易记录表
  - 签到得积分（每日1分）
  - 分享得积分（每次2分）
  - 下载消耗积分（每次1分）
  
- [ ] 广告集成（2天）
  - 集成百度联盟或Google AdSense
  - 在详情页和下载弹窗显示广告
  - 实现激励视频广告（观看30秒获取下载）
  
- [ ] 邮箱验证下载（2天）
  - 首次下载需要输入邮箱
  - 发送验证邮件（使用Resend）
  - 记录用户邮箱到数据库
  
- [ ] 邮件营销（1天）
  - 实现每周推荐邮件
  - 基于用户浏览历史个性化推荐
  - 添加退订功能

**验收标准**：
- ✅ DAU > 100
- ✅ 注册转化率 > 20%
- ✅ 下载转化率 > 30%
- ✅ 广告收益 > $300/月
- ✅ 积分购买收益 > $200/月
- ✅ 邮件打开率 > 20%

**技术栈**：
- 复用：Better Auth + Stripe + Resend
- 新增：广告SDK（百度联盟/Google AdSense）
- 成本：约$50/月（Resend Pro + Stripe手续费）

---

### 阶段3：规模化优化（持续迭代）

**目标**：支持10万+模板，DAU>2000，月收入>$2000

**功能清单**：
- [ ] 性能优化
  - 添加Redis缓存热门搜索
  - 优化数据库查询（索引、分页）
  - 使用CDN加速静态资源
  
- [ ] 成本优化
  - 迁移到自建Milvus（月省$70）
  - 使用DeepSeek替代OpenAI（月省$100）
  - 压缩预览图减少存储成本
  
- [ ] 管理后台
  - 模板管理（上传、编辑、删除）
  - 用户管理（查看、封禁）
  - 数据统计（DAU、收入、转化率）
  
- [ ] 高级功能
  - AI自动生成模板摘要
  - 多语言支持（英文）
  - 移动端优化

**验收标准**：
- ✅ 支持10万+模板
- ✅ DAU > 2000
- ✅ 月收入 > $2000
- ✅ 系统可用性 > 99.9%
- ✅ 页面加载时间 < 2秒

**技术栈**：
- 新增：自建Milvus + Redis + DeepSeek API
- 成本：约$200/月（服务器 + API）
```

**优点**：
- 每个阶段有明确的目标和时间
- 功能清单详细，包含工作量估算
- 验收标准量化且可验证
- 技术栈和成本清晰
- 考虑了风险和依赖关系

---

## 总结：好需求的5个特征

### 1. 具体化
- 使用EARS格式而非抽象描述
- 用场景化描述而非功能列表
- 有明确的触发条件和响应行为

### 2. 可验证
- 有量化的验收标准
- 有明确的成功指标
- 可以编写测试用例

### 3. 有依据
- 技术选型有对比和理由
- 阶段划分有优先级依据
- 成本预估有数据支撑

### 4. 可执行
- 开发人员能据此编码
- 测试人员能据此测试
- 产品经理能据此验收

### 5. 完整性
- 覆盖功能需求和非功能需求
- 考虑正常流程和异常流程
- 包含技术实现和验证方式

---

**下一步**：使用 `templates/` 目录中的模板，开始编写你的第一份高质量需求文档！
